Initializing model to count parameters...
OBS SIZE (1, 1, 8728)

========================================
 TOTAL TRAINABLE PARAMETERS: 2,363,318
========================================
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/maytus/MA-Craftax-Ox/baselines/dte_ppo_rmt.py", line 633, in <module>
    main()
  File "/home/maytus/MA-Craftax-Ox/baselines/dte_ppo_rmt.py", line 629, in main
    single_run(config)
  File "/home/maytus/MA-Craftax-Ox/baselines/dte_ppo_rmt.py", line 618, in single_run
    outs = jax.block_until_ready(train_vjit(rngs))
  File "/home/maytus/MA-Craftax-Ox/baselines/dte_ppo_rmt.py", line 238, in train
    network_params = jax.vmap(network.init, in_axes=(0, 0, 0))(init_rngs, init_hstate, init_x)
  File "/home/maytus/MA-Craftax-Ox/baselines/dte_ppo_rmt.py", line 149, in __call__
    new_memory, embedding_out = ScannedRMT(config=self.config)(memory, rmt_in)
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/flax/core/axes_scan.py", line 166, in scan_fn
    _, out_pvals, _ = pe.trace_to_jaxpr_nounits(f_flat, in_pvals)
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/flax/core/axes_scan.py", line 135, in body_fn
    broadcast_out, c, ys = fn(broadcast_in, c, *xs)
  File "/home/maytus/MA-Craftax-Ox/baselines/dte_ppo_rmt.py", line 97, in __call__
    dones[:, np.newaxis],
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 1083, in op
    return getattr(self.aval, f"_{name}")(self, *args)
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 657, in _getitem
    return indexing.rewriting_take(self, item)
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/numpy/indexing.py", line 653, in rewriting_take
    return internal_gather(arr, dynamic_idx)
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/numpy/indexing.py", line 662, in _gather
    indexer = index_to_gather(np.shape(arr), idx)  # shared with _scatter_update
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/numpy/indexing.py", line 799, in index_to_gather
    idx = _canonicalize_tuple_index(len(x_shape), idx)
  File "/home/maytus/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/numpy/indexing.py", line 1118, in _canonicalize_tuple_index
    raise IndexError(
IndexError: Too many indices: 0-dimensional array indexed with 1 regular index.
